<!DOCTYPE html>
<html>
  <head>
    <title>Anaphora eng</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <script src="https://unpkg.com/jspsych@7.0.0"></script>
    <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe@0.4"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.0.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.0.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-text@1.0.0"></script>
    <link href="https://unpkg.com/jspsych@7.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
  </head>
  <body></body>
  <script>
    
    /* initialize jsPsych */
    var jsPsych = initJsPsych({
      on_finish: function() {
        jsPsych.data.displayData();
      }
    });

    var subject_id = jsPsych.randomization.randomID(10);
    
    var filename = `${subject_id}.csv`;

    /* create timeline */
    var timeline = [];

    /* define welcome message trial */
    var welcome = {
      type: jsPsychHtmlButtonResponse,
      stimulus: "Welcome to this experiment! Please press the 'continue' button to begin.",
      choices: ['continue'],
    };
    timeline.push(welcome);

        /* define instructions */
        var instructions = {
        type: jsPsychHtmlButtonResponse,
        stimulus: `
          <p>In this experiment, you will see a sentence on the screen.</p>
          <p>The sentence will include two characters and a pronoun.</p>
          <p>Please decide which character the pronoun refers to.</p>
          <p>Let's start with a practice question before the experiment begins.</p> 
          <p>Press the 'continue' button to start.</p>
        `,
        choices: ['continue'],
        margin_vertical: '10px',
        margin_horizontal: '20px',
    };
    timeline.push(instructions);

    var fixation = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: jsPsych.NO_KEYS,
      trial_duration: 1000,
      data: {
        task: 'fixation'
      }
    };
    timeline.push(fixation);

    /* practice trial */
    var practice_trial = {
      type: jsPsychHtmlButtonResponse, //displays HTML content and records responses generated by button click
      stimulus: "<p><strong>Tom saw that Alex was chatting with his friend.</strong></p> <p>To whom does 'his' refer in 'his friend'?</p>",
      choices: ['Tom', 'Alex'], //choices: Labels for the buttons.
      margin_vertical: '10px',
      margin_horizontal: '20px',
      data: {
        task: 'practice'
      } //tag data
    };
    timeline.push(practice_trial);

    var transition = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
          <p>Practice is over. The experiment will start.</p> 
          <p>Press the 'continue' button to begin.</p>
        `,
        choices: ['continue'],
        margin_vertical: '10px',
        margin_horizontal: '20px',
        post_trial_gap: 1000
    };
    timeline.push(transition);
    
    var test_stimuli = [
      { stimulus: "<p><strong>Ray saw that Will was talking to his friend.</strong></p> <p> To whom does 'his' refer in 'his friend'?</p>", selection: ["Ray", "Will"]},
      { stimulus: "<p><strong>Leo detected that Tony was whispering to his colleague.</strong></p> <p> To whom does 'his' refer in 'his colleague'?</p>", selection: ["Leo", "Tony"]},
      { stimulus: "<p><strong>Gavin learned that Frank was preparing for the competition with his alumni.</strong></p> <p> To whom does 'his' refer in 'his alumni'?</p>", selection: ["Gavin", "Frank"]},
      { stimulus: "<p><strong>Harry discovered that Ben was altering his computer password.</strong></p> <p> To whom does 'his' refer in 'his computer password'?</p>", selection: ["Harry", "Ben"]},
      { stimulus: "<p><strong>Jack found that John lost his phone.</strong></p> <p> To whom does 'his' refer in 'his phone'?</p>", selection: ["Jack", "John"]},
      { stimulus: "<p><strong>Henry realized that Ryan hid his shoes.</strong></p> <p> To whom does 'his' refer in 'his shoes'?</p>", selection: ["Henry", "Ryan"]},
      { stimulus: "<p><strong>Cindy heard that Wendy was going to call her teacher.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Cindy", "Wendy"]},
      { stimulus: "<p><strong>Lily knew that Flora was preparing food with her bestie.</strong></p> <p> To whom does 'her' refer in 'her bestie'?</p>", selection: ["Lily", "Flora"]},
      { stimulus: "<p><strong>Ivy observed that Chloe was helping her brother pack toys.</strong></p> <p> To whom does 'her' refer in 'her brother'?</p>", selection: ["Ivy", "Chloe"]},
      { stimulus: "<p><strong>Ada perceived that Sherry was eating her cake.</strong></p> <p> To whom does 'her' refer in 'her cake'?</p>", selection: ["Ada", "Sherry"]},
      { stimulus: "<p><strong>Lila spotted that Elaine was petting her cat.</strong></p> <p> To whom does 'her' refer in 'her cat'?</p>", selection: ["Lila", "Elaine"]},
      { stimulus: "<p><strong>Zoe mentioned that Amy repaired her bracelet.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Zoe", "Amy"]},
      { stimulus: "<p><strong>Ray suddenly saw that Will was talking to his friend.</strong></p> <p>To whom does 'his' refer in 'his friend'?</p>", selection: ["Ray", "Will"]},
      { stimulus: "<p><strong>Leo occasionally detected that Tony was whispering to his colleague.</strong></p> <p> To whom does 'his' refer in 'his colleague'?</p>", selection: ["Leo", "Tony"]},
      { stimulus: "<p><strong>Gavin briefly learned that Frank was preparing for the competition with his alumni.</strong></p> <p> To whom does 'his' refer in 'his alumni'?</p>", selection: ["Gavin", "Frank"]},
      { stimulus: "<p><strong>Harry unexpectedly discovered that Ben was altering his computer password.</strong></p> <p> To whom does 'his' refer in 'his computer password'?</p>", selection: ["Harry", "Ben"]},
      { stimulus: "<p><strong>Jack finally found that John lost his phone.</strong></p> <p> To whom does 'his' refer in 'his phone'?</p>", selection: ["Jack", "John"]},
      { stimulus: "<p><strong>Henry eventually realized that Ryan hid his shoes.</strong></p> <p> To whom does 'his' refer in 'his shoes'?</p>", selection: ["Henry", "Ryan"]},
      { stimulus: "<p><strong>Cindy recently heard that Wendy was going to call her teacher.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Cindy", "Wendy"]},
      { stimulus: "<p><strong>Lily clearly knew that Flora was preparing food with her bestie.</strong></p> <p> To whom does 'her' refer in 'her bestie'?</p>", selection: ["Lily", "Flora"]},
      { stimulus: "<p><strong>Ivy quickly observed that Chloe was helping her brother pack toys.</strong></p> <p> To whom does 'her' refer in 'her brother'?</p>", selection: ["Ivy", "Chloe"]},
      { stimulus: "<p><strong>Ada easily perceived that Sherry was eating her cake.</strong></p> <p> To whom does 'her' refer in 'her cake'?</p>", selection: ["Ada", "Sherry"]},
      { stimulus: "<p><strong>Lila accidentally spotted that Elaine was petting her cat.</strong></p> <p> To whom does 'her' refer in 'her cat'?</p>", selection: ["Lila", "Elaine"]},
      { stimulus: "<p><strong>Zoe deliberately mentioned that Amy repaired her bracelet.</strong></p> <p> To whom does 'her' refer in 'her bracelet'?</p>", selection: ["Zoe", "Amy"]},
      { stimulus: "<p><strong>Ray suddenly saw with curiosity that Will was talking to his friend.</strong></p> <p> To whom does 'his' refer in 'his friend'?</p>", selection: ["Ray", "Will"]},
      { stimulus: "<p><strong>Leo occasionally detected with clarity that Tony was whispering to his colleague.</strong></p> <p> To whom does 'his' refer in 'his colleague'?</p>", selection: ["Leo", "Tony"]},
      { stimulus: "<p><strong>Gavin briefly learned with interest that Frank was preparing for the competition with his alumni.</strong></p> <p> To whom does 'his' refer in 'his alumni'?</p>", selection: ["Gavin", "Frank"]},
      { stimulus: "<p><strong>Harry unexpectedly discovered with suspicion that Ben was altering his computer password.</strong></p> <p> To whom does 'his' refer in 'his computer password'?</p>", selection: ["Harry", "Ben"]},
      { stimulus: "<p><strong>Jack finally found with annoyance that John lost his phone.</strong></p> <p> To whom does 'his' refer in 'his phone'?</p>", selection: ["Jack", "John"]},
      { stimulus: "<p><strong>Henry eventually realized with confusion that Ryan hid his shoes.</strong></p> <p> To whom does 'his' refer in 'his shoes'?</p>", selection: ["Henry", "Ryan"]},
      { stimulus: "<p><strong>Cindy recently heard with apprehension that Wendy was going to call her teacher.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Cindy", "Wendy"]},
      { stimulus: "<p><strong>Lily clearly knew with disappointment that Flora was preparing food with her bestie.</strong></p> <p> To whom does 'her' refer in 'her bestie'?</p>", selection: ["Lily", "Flora"]},
      { stimulus: "<p><strong>Ivy quickly observed with joy that Chloe was helping her brother pack toys.</strong></p> <p> To whom does 'her' refer in 'her brother'?</p>", selection: ["Ivy", "Chloe"]},
      { stimulus: "<p><strong>Ada easily perceived with amazement that Sherry was eating her cake.</strong></p> <p> To whom does 'her' refer in 'her cake'?</p>", selection: ["Ada", "Sherry"]},
      { stimulus: "<p><strong>Lila accidentally spotted with tenderness that Elaine was petting her cat.</strong></p> <p> To whom does 'her' refer in 'her cat'?</p>", selection: ["Lila", "Elaine"]},
      { stimulus: "<p><strong>Zoe deliberately mentioned with delight that Amy repaired her bracelet.</strong></p> <p> To whom does 'her' refer in 'her bracelet'?</p>", selection: ["Zoe", "Amy"]}
    ];

    var fixation1 = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: "NO_KEYS",
      trial_duration: 1000,
      data: {
        task: 'fixation'
      }
    };

    var test = {
      type: jsPsychHtmlButtonResponse,
      stimulus: jsPsych.timelineVariable('stimulus'),
      choices: jsPsych.timelineVariable('selection'),
      margin_vertical: '10px',
      margin_horizontal: '20px',
      data: {
        task: 'response'
      }
    }

    var test_procedure = {
      timeline: [fixation1, test],
      timeline_variables: test_stimuli,
      randomize_order: true
    }
    timeline.push(test_procedure);

    var test_stimuli = [
      { stimulus: "<p><strong>Ray saw that Will was talking to his friend.</strong></p> <p> To whom does 'his' refer in 'his friend'?</p>", selection: ["Ray", "Will"]},
      { stimulus: "<p><strong>Leo detected that Tony was whispering to his colleague.</strong></p> <p> To whom does 'his' refer in 'his colleague'?</p>", selection: ["Leo", "Tony"]},
      { stimulus: "<p><strong>Gavin learned that Frank was preparing for the competition with his alumni.</strong></p> <p> To whom does 'his' refer in 'his alumni'?</p>", selection: ["Gavin", "Frank"]},
      { stimulus: "<p><strong>Harry discovered that Ben was altering his computer password.</strong></p> <p> To whom does 'his' refer in 'his computer password'?</p>", selection: ["Harry", "Ben"]},
      { stimulus: "<p><strong>Jack found that John lost his phone.</strong></p> <p> To whom does 'his' refer in 'his phone'?</p>", selection: ["Jack", "John"]},
      { stimulus: "<p><strong>Henry realized that Ryan hid his shoes.</strong></p> <p> To whom does 'his' refer in 'his shoes'?</p>", selection: ["Henry", "Ryan"]},
      { stimulus: "<p><strong>Cindy heard that Wendy was going to call her teacher.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Cindy", "Wendy"]},
      { stimulus: "<p><strong>Lily knew that Flora was preparing food with her bestie.</strong></p> <p> To whom does 'her' refer in 'her bestie'?</p>", selection: ["Lily", "Flora"]},
      { stimulus: "<p><strong>Ivy observed that Chloe was helping her brother pack toys.</strong></p> <p> To whom does 'her' refer in 'her brother'?</p>", selection: ["Ivy", "Chloe"]},
      { stimulus: "<p><strong>Ada perceived that Sherry was eating her cake.</strong></p> <p> To whom does 'her' refer in 'her cake'?</p>", selection: ["Ada", "Sherry"]},
      { stimulus: "<p><strong>Lila spotted that Elaine was petting her cat.</strong></p> <p> To whom does 'her' refer in 'her cat'?</p>", selection: ["Lila", "Elaine"]},
      { stimulus: "<p><strong>Zoe mentioned that Amy repaired her bracelet.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Zoe", "Amy"]},
      { stimulus: "<p><strong>Ray suddenly saw that Will was talking to his friend.</strong></p> <p>To whom does 'his' refer in 'his friend'?</p>", selection: ["Ray", "Will"]},
      { stimulus: "<p><strong>Leo occasionally detected that Tony was whispering to his colleague.</strong></p> <p> To whom does 'his' refer in 'his colleague'?</p>", selection: ["Leo", "Tony"]},
      { stimulus: "<p><strong>Gavin briefly learned that Frank was preparing for the competition with his alumni.</strong></p> <p> To whom does 'his' refer in 'his alumni'?</p>", selection: ["Gavin", "Frank"]},
      { stimulus: "<p><strong>Harry unexpectedly discovered that Ben was altering his computer password.</strong></p> <p> To whom does 'his' refer in 'his computer password'?</p>", selection: ["Harry", "Ben"]},
      { stimulus: "<p><strong>Jack finally found that John lost his phone.</strong></p> <p> To whom does 'his' refer in 'his phone'?</p>", selection: ["Jack", "John"]},
      { stimulus: "<p><strong>Henry eventually realized that Ryan hid his shoes.</strong></p> <p> To whom does 'his' refer in 'his shoes'?</p>", selection: ["Henry", "Ryan"]},
      { stimulus: "<p><strong>Cindy recently heard that Wendy was going to call her teacher.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Cindy", "Wendy"]},
      { stimulus: "<p><strong>Lily clearly knew that Flora was preparing food with her bestie.</strong></p> <p> To whom does 'her' refer in 'her bestie'?</p>", selection: ["Lily", "Flora"]},
      { stimulus: "<p><strong>Ivy quickly observed that Chloe was helping her brother pack toys.</strong></p> <p> To whom does 'her' refer in 'her brother'?</p>", selection: ["Ivy", "Chloe"]},
      { stimulus: "<p><strong>Ada easily perceived that Sherry was eating her cake.</strong></p> <p> To whom does 'her' refer in 'her cake'?</p>", selection: ["Ada", "Sherry"]},
      { stimulus: "<p><strong>Lila accidentally spotted that Elaine was petting her cat.</strong></p> <p> To whom does 'her' refer in 'her cat'?</p>", selection: ["Lila", "Elaine"]},
      { stimulus: "<p><strong>Zoe deliberately mentioned that Amy repaired her bracelet.</strong></p> <p> To whom does 'her' refer in 'her bracelet'?</p>", selection: ["Zoe", "Amy"]},
      { stimulus: "<p><strong>Ray suddenly saw with curiosity that Will was talking to his friend.</strong></p> <p> To whom does 'his' refer in 'his friend'?</p>", selection: ["Ray", "Will"]},
      { stimulus: "<p><strong>Leo occasionally detected with clarity that Tony was whispering to his colleague.</strong></p> <p> To whom does 'his' refer in 'his colleague'?</p>", selection: ["Leo", "Tony"]},
      { stimulus: "<p><strong>Gavin briefly learned with interest that Frank was preparing for the competition with his alumni.</strong></p> <p> To whom does 'his' refer in 'his alumni'?</p>", selection: ["Gavin", "Frank"]},
      { stimulus: "<p><strong>Harry unexpectedly discovered with suspicion that Ben was altering his computer password.</strong></p> <p> To whom does 'his' refer in 'his computer password'?</p>", selection: ["Harry", "Ben"]},
      { stimulus: "<p><strong>Jack finally found with annoyance that John lost his phone.</strong></p> <p> To whom does 'his' refer in 'his phone'?</p>", selection: ["Jack", "John"]},
      { stimulus: "<p><strong>Henry eventually realized with confusion that Ryan hid his shoes.</strong></p> <p> To whom does 'his' refer in 'his shoes'?</p>", selection: ["Henry", "Ryan"]},
      { stimulus: "<p><strong>Cindy recently heard with apprehension that Wendy was going to call her teacher.</strong></p> <p> To whom does 'her' refer in 'her teacher'?</p>", selection: ["Cindy", "Wendy"]},
      { stimulus: "<p><strong>Lily clearly knew with disappointment that Flora was preparing food with her bestie.</strong></p> <p> To whom does 'her' refer in 'her bestie'?</p>", selection: ["Lily", "Flora"]},
      { stimulus: "<p><strong>Ivy quickly observed with joy that Chloe was helping her brother pack toys.</strong></p> <p> To whom does 'her' refer in 'her brother'?</p>", selection: ["Ivy", "Chloe"]},
      { stimulus: "<p><strong>Ada easily perceived with amazement that Sherry was eating her cake.</strong></p> <p> To whom does 'her' refer in 'her cake'?</p>", selection: ["Ada", "Sherry"]},
      { stimulus: "<p><strong>Lila accidentally spotted with tenderness that Elaine was petting her cat.</strong></p> <p> To whom does 'her' refer in 'her cat'?</p>", selection: ["Lila", "Elaine"]},
      { stimulus: "<p><strong>Zoe deliberately mentioned with delight that Amy repaired her bracelet.</strong></p> <p> To whom does 'her' refer in 'her bracelet'?</p>", selection: ["Zoe", "Amy"]}
    ];

    var fixation1 = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: "NO_KEYS",
      trial_duration: 1000,
      data: {
        task: 'fixation'
      }
    };

    var test = {
      type: jsPsychHtmlButtonResponse,
      stimulus: jsPsych.timelineVariable('stimulus'),
      choices: jsPsych.timelineVariable('selection'),
      margin_vertical: '10px',
      margin_horizontal: '20px',
      data: {
        task: 'response'
      }
    }

    var test_procedure = {
      timeline: [fixation1, test],
      timeline_variables: test_stimuli,
      randomize_order: true
    }
    timeline.push(test_procedure);

    var debrief_block = {
      type: jsPsychHtmlButtonResponse,
      stimulus: function() {
        var trials = jsPsych.data.get().filter({task: 'response'});
        var rt = Math.round(trials.select('rt').mean());
        
        return `<p>The experiment is complete!</p>
        <p>Your average response time is ${rt}ms.</p>
        <p>Press the 'continue' button to end the experiment. Thank you for participating!</p>`;
      },
      choices: ['continue'],
      margin_vertical: '10px',
      margin_horizontal: '20px',
      post_trial_gap: 1000
    };
    timeline.push(debrief_block);
    
    var save_data = {
      type: jsPsychPipe,
      action: "save",
      experiment_id: "R9A9Km8xGdJo",
      filename: filename,
      data_string: ()=>jsPsych.data.get().csv()
    };
    timeline.push(save_data);

    jsPsych.run(timeline);
  
  </script>
</html>